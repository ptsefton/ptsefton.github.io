
<html>
<head>
    <title>ptsefton.com :: Challenge: Produce XHTML and print from a Word document</title>
<style>
.header {
  background-color: #ff00ff;
  border-color: #b72bc0;
  color: #ffff00;
  padding-top: 12pt;
  padding-bottom: 12pt;
  font-family: monospace;
}




/* unvisited link */
a:link {
    color: #FF00FF;
}

.header a:link {
    color: #FFFF00;
    text-decoration: none; 
}

button {
    color: #ffff00;
    background-color: #ff00ff;
    font-family: monospace;
}

/* visited link */
a:visited {
    color: #FF00AA;
}

.header a:visited {
    color: #FFFF00;
}

h1, h2 {
    color: # FF00FF
}

/* mouse over link */
a:hover {
    color: #FF00AA;
}

/* selected link */
a:active {
    color: #0000FF;
}

a {
    text-decoration: none; 
}

img {
    max-width: 100%;
    display: block;
    margin-left: auto;
    margin-right: auto;
}
section img {
    width: 100%
}

td, th {
    padding-top: 20px;
    padding-right: 20px;
    vertical-align: top;
    text-align: left;
}

.content {
	font-family: Verdana, system-ui, Helvetica, sans-serif;
    line-height: 1.8em;
    }


.caption {
    text-align: center;
    background-color: rgba(255, 0, 255, 0.2); 
    padding-left: 5%;
    padding-right: 5%;
    padding-top: 2%;
    padding-bottom: 2%;
}

blockquote {
    font-style: italic;
    font-weight: bold;
    color: #FF00FF;

    background-color: rgba(255, 255, 0, 0.2); 
    padding-left: 5%;
    padding-right: 5%;
    padding-top: 2%;
    padding-bottom: 2%;
}


@media  screen and (min-width:  900px) {
    .content, .header {
        width: 60%;
        padding-left: 20%;
        padding-right: 30%;
    }
    .row {
    display: grid;
    grid-template-columns: 75% 25%;
}
    
}

@media  screen and (min-width: 1200px) {
    .content, .header {
        width: 55%;
        padding-left: 20%;
        padding-right: 30%;
    }
    .row {
        display: grid;
        grid-template-columns: 75% 25%;
}
    
}


.date {
      font-style: italic;
}

.cat p {
        line-height: 1em;
}

</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-898010-1', 'auto');
  ga('send', 'pageview');
</script>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6JNHBJL67Q"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6JNHBJL67Q');
</script>

<body>
    <div class="header">
        <h2><a href="/">[ptsefton.com]</a> | <a href="/Pages/cv.html"> [CV & Bio] </a></h2>
    </div>


    <div class="content">
        <h1> 
        Challenge: Produce XHTML and print from a Word document 
        </h1>
        <h2>2007-07-02 </h2>

        <p><a href="/blog/2007/07/02/the_web_with_word/100.pdf">View this page as PDF</a></p>
<div>
<p>I'm working on a paper about how we <a href="http://del.icio.us/ptsefton/usestyles">use
styles</a> in the
<a href="http://ice.usq.edu.au/">ICE</a> system to structure and format documents
for print and the web. To help define the problem and show why an
ICE-like approach is needed I decided to see how far I got trying to
format a paper for print and the web using out-of-the-box word
processing tools.</p>
<p>I covered this a little before when I <a href="http://ptsefton.com/blog/2005/10/31/why_do_i_keep_going_on_about_html_export_from_word_processors%3F">got
cranky</a>
about the HTML export in OpenOffice.org, but I haven't eviscerated
Microsoft Word's HTML export here in detail.</p>
<p>So, here's the challenge.</p>
<p>Can I take my recent paper, <a href="http://eprints.usq.edu.au/archive/00002653/">An integrated approach to preparing,
publishing, presenting and preserving
theses</a> for the ETD
conference. I <a href="http://ptsefton.com/blog/2007/05/15/etd_paper">wrote
recently</a> about how I
prepared this paper using ICE, meaning that of course I can produce both
print and web versions, but how would I go using Word 2003 on Windows
XP? Could I produce XHTML? This is, after all the year 2007 and the
World Wide Web is in its late teens. (I didn't use Word 2007 because I
don't have a copy, but I'll find one and try that too)</p>
<p>The biggest challenge, I knew, would be getting stuff that looks OK on
screen to export to the correct HTML elements.</p>
<p>So here's the procedure: (I know this looks boring, but if you know a
<code>&lt;ul&gt;</code> from a <code>&lt;p&gt;</code> you'll find it hysterically funny I promise)</p>
<ol>
<li>
<p>Open a new blank document.</p>
</li>
<li>
<p>Look in the styles pane showing at the left of the page; only a
couple of styles there so;</p>
</li>
<li>
<p>Select All styles from the Show drop down:
<img src="/blog/2007/07/02/the_web_with_word/1.jpg" alt="graphics1"></p>
</li>
<li>
<p>That's better <span class="spCh spChx2013">–</span> there are lots
of heading styles and some HTML styles that should come in handy.</p>
</li>
<li>
<p>Select the <code>Title</code> style and type the title</p>
</li>
<li>
<p>Select the <code>Heading 1</code> style and type the first heading (lets forget
about the abstract for now)</p>
</li>
<li>
<p>Type a few paragraphs of plain text.</p>
</li>
<li>
<p>Look in the style pane and work out that there's no blockquote
style. Weirdly there is a built-in style called <code>HTML Preformatted</code>.</p>
</li>
<li>
<p>Save the document as a web page and note that the headings have
worked.</p>
</li>
<li>
<p>Realize that you've saved it as a <code>.mht</code> whatever that is.</p>
</li>
<li>
<p>Save the document as HTML.</p>
</li>
<li>
<p>Look at the document in Firefox. Looks OK.</p>
</li>
<li>
<p>View source. Yuck!</p>
</li>
<li>
<p>Save the document as Filtered HTML . Hmmmm Filtered.</p>
</li>
<li>
<p>Have a look at the first bit of blockquote:</p>
<p>&lt;p style='margin-top:13.05pt;margin-right:0cm;margin-bottom:0cm;margin-left:</p>
<p>0cm;margin-bottom:.0001pt'&gt;<span lang=EN-US style='font-size:11.0pt'>ICE-RS is</p>
<p>supported by the Systemic Infrastructure Initiative as part of the Australian</p>
<p>Commonwealth Government's Backing Australia's Ability – An Innovative Action</p>
<p>Plan for the Future (http://backingaus.innovation.gov.au).</span></p></p>
<p>Oh dear!</p>
<p>(Those extra spans with 11pt text are because I copied an pasted
rather than typing: I'd need to turn that into default paragraph
font. Easy enough on Windows, but apparently impossible in the Mac
version of Word <span class="spCh spChx2013">–</span> they left that
bit out!)</p>
</li>
<li>
<p>Use your 1337 skills to change the HTML that word exported to be
proper: XHTML:</p>
<p><blockquote>ICE-RS is</p>
<p>supported by the Systemic Infrastructure Initiative as part of the Australian</p>
<p>Commonwealth Government's Backing Australia's Ability - An Innovative Action</p>
<p>Plan for the Future (http://backingaus.innovation.gov.au).</blockquote></p>
</li>
<li>
<p>Load the document back in to Word to see what happens.</p>
</li>
<li>
<p>Observe that Word has turned the blockquote abck into a paragraph of
Normal text.</p>
</li>
<li>
<p>Save the document.</p>
</li>
<li>
<p>Look at the source.</p>
<p><blockquote style="margin-top: 5pt; margin-bottom: 5pt;"></p>
<p><p class="MsoNormal">ICE-RS is supported by the Systemic Infrastructure</p>
<p>Initiative as part of the Australian Commonwealth Government's Backing</p>
<p>Australia's Ability – An Innovative Action Plan for the Future</p>
<p>(http://backingaus.innovation.gov.au).</p></p>
<p></blockquote></p>
<p>Wow! There's still a blockquote there, but guess what? In Word you
can't <em>see</em> that it's there!</p>
</li>
<li>
<p>Add some more text to the blockquote by going to the end of the
paragraph.</p>
</li>
<li>
<p>Save the document.</p>
</li>
<li>
<p>Check that yes, you have added to the blockquote.</p>
</li>
<li>
<p>Back in the document, experiment with the demote button, the
left-facing arrow <code>&lt;-</code>. The first part of the blockquote won't move,
but the second will. Here it is as rendered on-screen in Word.</p>
<p><img src="/blog/2007/07/02/the_web_with_word/2.jpg" alt="graphics2"></p>
</li>
<li>
<p>Guess what the HTML for that might look like. Here it is rendered in
Firefox:</p>
<div>
<p><img src="/blog/2007/07/02/the_web_with_word/3.jpg" alt="graphics3"></p>
</div>
</li>
<li>
<p>Look at source to see where the text 'Test adding more text ' has
gone.</p>
<p><blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'></p>
<p><p class=MsoNormal>ICE-RS is supported by the Systemic Infrastructure</p>
<p>Initiative as part of the Australian Commonwealth Government's Backing</p>
<p>Australia's Ability – An Innovative Action Plan for the Future (&lt;a</p>
<p>href=&quot;http://backingaus.innovation.gov.au/&quot;&gt;http://backingaus.innovation.gov.au</a>).</p></p>
<p><p class=MsoNormal style='margin-left:-180.0pt'>Test adding more text.</p></p>
<p></blockquote></p>
<p>You see that? Word has helpfully put on margin-left:-180.0pt. Hmm a
left margin of minus one hundred and eighty points.</p>
</li>
<li>
<p>Give up in disgust. I can't see a way to get Word 2007 to make a
blockquote.</p>
<p>(And I tried a couple of other things too, like guessing that if I
used a style like <code>HTML Blockquote</code> Word might magically Do (Nearly)
The Right Thing the way it does with <code>HTML Preformatted</code> style. It
doesn't it makes a paragraph with class <code>HTMLBlockquote</code> but with
the wrong CSS. Oh well.)</p>
</li>
</ol>
<p>Actually I can't give up because I have yet to play with the lists.</p>
<p>There's a bit in my paper where I have a blockquote with a list embedded
in it. That's pefectly possible in ICE, but would be very hard in Word.
So lets look for an easier case.</p>
<p>So how would we do this example with a numbered list, with some
pre-formatted text embedded in it? (note that the actual document has a
rendering mistake in it that I have fixed here).</p>
<p><img src="/blog/2007/07/02/the_web_with_word/4.jpg" alt="graphics4"></p>
<p>I used the built-in styles <code>List Number 1</code>, <code>List Continue</code> and
<code>HTML Preformatted</code> (with a hit on the indent button).</p>
<p>Result <em>looks</em> OK in Firefox but it's a million miles from being XHTML.
The list is not a list at all, it's a paragraph with some creative
formatting and a bunch of non-breaking spaces. Really. I used to know
this stuff intimately <span class="spCh spChx2013">–</span> see <a href="http://www.xml.com/pub/a/2004/12/08/word-to-xml.html">my
article</a> on
geeting XML out of Word for xml.com.</p>
<p><p class=MsoListNumber><span lang=EN-US>1.<span style='font:7.0pt "Times New Roman"'>     </p>
<p></span></span><span lang=EN-US>Initially the handle will resolve to the</p>
<p>server-side ICE repository, which because it is in the Subversion system is</p>
<p>web-addressable, although usually authentication will be required.</span></p></p>
<p>At this point I'd give up, but I love them lists too much. So, why not
try ignoring styles and using the formatting buttons.</p>
<p>Nope. Still no list. It's the same nonsense but without any CSS.</p>
<p><p style="margin-left: 36pt; text-indent: -18pt;"></p>
<p><span lang="EN-US">1.&lt;span style=&quot;font-family: &quot;Times New Roman&quot;;</p>
<p>font-style: normal; font-variant: normal; font-weight: normal;</p>
<p>font-size: 7pt; line-height: normal; font-size-adjust: none;</p>
<p>font-stretch: normal;&quot;&gt;      </span></p>
<p></span><span lang="EN-US">Initially the handle will resolve to the server-side ICE repository,</p>
<p>which because it is in the Subversion system is web-addressable, although</p>
<p>usually authentication will be required.</span></p></p>
<h1><span id="id2"></span>Conclusion</h1>
<p>This sux.</p>
<p>The worst bit was when I managed to get a word document that contained a
blockquote that is invisible through the editing interface, but which
creates nightmares like invisible paragraphs with their left margin
miles off the screen.</p>
<p>If you gave Word 2003 to somebody and asked them to write a paper that
could be given to a fussy HTML publisher and also printed with nice
headers and footers, or saved to PDF then they'd be stuck.</p>
<p>Which I kind of knew, which is why we invented ICE. But I needed to go
through this so I can show the results for the paper I'm writing.</p>
<p>Next up, OpenOffice.org Writer. What do you think OOo fans? Will it do
any better? An how about Google Docs?</p>
</div>

    </div><script src="https://utteranc.es/client.js"
            repo="ptsefton/blog-comments"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>  
    </script></body>
</html>