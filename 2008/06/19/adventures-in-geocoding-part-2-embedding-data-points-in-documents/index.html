
<html>
<head>
    <title>ptsefton.com :: Adventures in Geocoding part 2: Embedding data points in documents</title>
<style>
.header {
    
  background-color: #ff00ff;
  border-color: #b72bc0;
  color: #ffff00;
  padding-top: 12pt;
  padding-bottom: 12pt;
  font-family: monospace;
}




/* unvisited link */
a:link {
    color: #FF00FF;
}

.header a:link {
    color: #FFFF00;
    text-decoration: none; 
}

button {
    color: #ffff00;
    background-color: #ff00ff;
    font-family: monospace;
}

/* visited link */
a:visited {
    color: #FF00AA;
}

.header a:visited {
    color: #FFFF00;
}

h1, h2 {
    color: # FF00FF
}

/* mouse over link */
a:hover {
    color: #FF00AA;
}

/* selected link */
a:active {
    color: #0000FF;
}

a {
    text-decoration: none; 
}

img {
    max-width: 100%
}
section img {
    width: 100%
}
td, th {
    padding-top: 20px;
    padding-right: 20px;
    vertical-align: top;
    text-align: left;
}

.content {
	font-family: Verdana, system-ui, Helvetica, sans-serif;
    line-height: 1.8em;
    }



@media  screen and (min-width:  900px) {
    .content, .header {
        width: 60%;
        padding-left: 20%;
        padding-right: 30%;
    }
    
}

@media  screen and (min-width: 1200px) {
    .content, .header {
        width: 40%;
        padding-left: 20%;
        padding-right: 30%;
    }
    
}


</style>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-898010-1', 'auto');
  ga('send', 'pageview');

</script>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6JNHBJL67Q"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6JNHBJL67Q');
</script>
<body>
<div class="header">
<h2><a href="/">[ptsefton.com]</a> | <a href="/Pages/cv.html"> [CV & Bio] </a></h2>


</div>


<div class="content">
<h1> 
Adventures in Geocoding part 2: Embedding data points in documents 
</h1>
<h2>2008-06-19 </h2>

<div>
<p>[update: the map doesn't seem to work well in IE - works well for me in
Firefox.]</p>
<script src="/jquery.js" type="text/javascript"><!-- --></script>
<script src="/geo.js" type="text/javascript"><!-- --></script>
<p><span class="pdf-rendition-link"><a href="/wp-content/uploads/2008/06/geocode-embedded1.pdf">View as
PDF</a></span></p>
<div class="page-toc">
</div>
<div>
<p>I have been thinking about how to start integrating more semantics into
<a href="http://ice.usq.edu.au/">ICE</a> documents. This is only a preliminary
look, but it's very promising so far.</p>
<p>A wrote a while ago about <a href="http://ptsefton.com/2008/05/02/adventures-in-geocoding-part-1-the-toowoomba-bug-cycle-hazard-investigation-team-does-ruthven-street.htm">embedding metadata in
pictures</a>.
This time I look at how one might embed geographical data in a document.</p>
<p>I was tempted to do a dog-poo map of East Toowoomba showing how my
hounds like to defecate as far as possible from a rubbish bin so I get
to carry the re-used plastic bag further, but I'll spare you that and
show you some thing else.</p>
<p>Take this cycle hazard for example. I have linked the picture it to a
web album where you can see it in context. The caption has the location
in the text so if you download the PDF you can find the location for
yourself.</p>
<p><a href="http://picasaweb.google.com/ptsefton/ToowoombaBUGHazardInspectionTeam/photo#5195619632523461826"><img src="/wp-content/uploads/2008/06/40536313s295x3931.jpg" alt="graphics1"></a></p>
<p><span class="geo">One of many hazardous grates on Ruthven Street
Toowoomba (-27.590334, 151.948166)</span></p>
<p>Or I could point out another dangerous place where <span class="geo">the
cycle lane disappears (-27.595667, 151.947174)</span>.</p>
<p>If everything is working correctly, you should see a map somewhere in
this post (I'm still wavering about where to put it) showing those two
points; and if you click on the little pins you will get the description
for that point. I doubt it will work in places like Google Reader so
click through to the post.</p>
<p>What I've developed here is actually not ICE specific. All I have done
is adapt little bit of Javascript of <a href="http://24ways.org/2007/unobtrusively-mapping-microformats-with-jquery">Simon
Willison's</a>
to go through a page and look for HTML elements marked with the class
attribute 'geo'. It's pretty dumb at the moment, and it relies on a
convention that each location has an optional description followed by
the coordinates in brackets. Only handles decimals, not degrees and
minutes and would spit the dummy if you said 27.6045<span
class="spCh spChxb0">°</span> S instead of -27.6045.</p>
<p>To use this in ICE I have to set up some javascript stuff to load
everything in, install it in the blog server and so on, which took me a
stupid amount of time, but in the documents themselves it couldn't be
easier. I defined a new style called <code>i-geo</code> (i is for inline) and ICE
automatically converts that to HTML spans with <code>class=”geo”</code> when I
generate the HTML.</p>
<p>By coincidence, there was a post this week from Roderic Page on <a href="http://iphylo.blogspot.com/2008/06/from-pdfs-to-google-earth.html">mining
PDFs for geographical
data</a>.
Great stuff. It's very like the work that <a href="http://wwmm.ch.cam.ac.uk/blogs/murrayrust/">Peter-Murray
Rust's</a> group and others do
with mining chemistry data from PDFs. But there are problems:</p>
<blockquote>
<p>The service uses a bunch of regular expressions to try and extract
latitude and longitude pairs from the text (needless to say, there are
nearly as many different ways to write a latitude and longitude as
there are authors).</p>
<p><a href="http://iphylo.blogspot.com/2008/06/from-pdfs-to-google-earth.html">http://iphylo.blogspot.com/2008/06/from-pdfs-to-google-earth.html</a></p>
</blockquote>
<p>What we want to do in ICE is provide authors with easy to use tools so
they can unambiguously encode data and validate it <strong>before</strong> they hit
the 'publish' button. One way we plan to do this is to adapt an
application like Roderic's tool. In this case I'd point it at my
document and it could tag all the coordinates I've got and normalize
them to my preferred method of expressing coordinates, then mark them up
in some way. Ultimately this will be more robust than these fragile
after-the-fact scraping services. My document will be able to advertise
its own meaningful content not cling to it jealously until it is exhumed
by an application later on which has to pry it out of its cold dead
PDF-fingers.</p>
<p>We're going to do something like this with the <a href="http://www.jisc.ac.uk/whatwedo/programmes/digitalrepositories2007/theorem-ice.aspx">TheOREM
project</a>,
too. It's in the work plan to run the
<a href="http://www.rsc.org/Publishing/ReSourCe/AuthorGuidelines/AuthoringTools/ExperimentalDataChecker/getOSCAR.asp">OSCAR</a>
chemistry-sniffer-outer application over documents and get it to mark
all the bits of chemistry, as well as give its automatic sanity check;
once that's done we can start pushing out chemistry with built-in
semantics.</p>
<p>Now, I bet if <a href="http://community.muohio.edu/blogs/darcusb/">Bruce
D'Arcus</a> is reading this
he'd be saying 'Use <a href="http://community.muohio.edu/blogs/darcusb/archives/2008/05/07/openoffice-30-beta-and-metadata">the new metadata support in ODF
1.2</a>'
and I will investigate that. But, given the user base I deal with an
OpenOffice.org only solution is not optimal <span
class="spCh spChx2013">–</span> we also need a solution that will work
for groups who use other tools such as Microsoft Word. The Style based
microformat approach is one such interoperable mechanism. Styles work,
but are bit tricky to apply. I like simple links even better.</p>
<p>In the geo-world geohash looks pretty cool. Geohash is an algorithm
which can turn this:</p>
<p><span
style="display: block"><a name="graphics2"></a><img src="/wp-content/uploads/2008/06/4a8714b5s552x1361.jpg" alt="graphics2"></span></p>
<p>Into this short URL: http://geohash.org/r7h51ehscv0g</p>
<p>I have set up my little Javascript experiment so that if I add a link it
will automatically push a pin into my map. The Geohash algorithm is
open, so I don't need the Geohash service to use it. I found an <a href="http://github.com/davetroy/geohash-js/tree/master">open
source library easily
enough</a>, and the URL
makes a perfectly good identifier in my opinion. Yeah yeah it's got the
http protocol on the front but it's a unique string for a point on the
earth and more importantly I can use it in pretty much any modern
editor.</p>
<p>So I could use a simple link to point out a place where <a href="http://geohash.org/r7h51enkzthe">the road is in
terrible condition</a>and have that point
show up on my map. If you grab the PDF version of this page, you'll see
that the links are all footnoted automatically so I don't have to type
in coordinates or mess with styles. I just link. ICE has a nice feature
where it can footnote all the links in my documents for the PDF version,
too so the information is there in a usable form in print . If we wanted
to get really fancy it could decode the Geohash into a human readable
format for the print view.</p>
<p>What I'm thinking about now is a framework for semantic markup in word
processors and beyond that takes into account all the prior art
(smart-tags in Word for example) and the practical realities of
mixed-application workgroups and a Microsoft-heavy world. I might try to
put something together for the forthcoming <a href="http://www.eresearch.edu.au/ahch-workshop">e-Research in the Arts,
Humanities and Cultural Heritage
workshop</a>. We have a
part-written paper about embedding metadata in documents lying around
that may serve as a base.</p>
</div>
</div>

</div><script src="https://utteranc.es/client.js"
        repo="ptsefton/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script></body>
</html>