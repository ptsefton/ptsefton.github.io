
<html>
<head>
    <title>ptsefton.com :: Some comments on OOXML, ODF and Microsoft Word</title>
<style>
.header {
  background-color: #ff00ff;
  border-color: #b72bc0;
  color: #ffff00;
  padding-top: 12pt;
  padding-bottom: 12pt;
  font-family: monospace;
}




/* unvisited link */
a:link {
    color: #FF00FF;
}

.header a:link {
    color: #FFFF00;
    text-decoration: none; 
}

button {
    color: #ffff00;
    background-color: #ff00ff;
    font-family: monospace;
}

/* visited link */
a:visited {
    color: #FF00AA;
}

.header a:visited {
    color: #FFFF00;
}

h1, h2 {
    color: # FF00FF
}

/* mouse over link */
a:hover {
    color: #FF00AA;
}

/* selected link */
a:active {
    color: #0000FF;
}

a {
    text-decoration: none; 
}

img {
    max-width: 100%;
    display: block;
    margin-left: auto;
    margin-right: auto;
}
section img {
    width: 100%
}

td, th {
    padding-top: 20px;
    padding-right: 20px;
    vertical-align: top;
    text-align: left;
}

.content {
	font-family: Verdana, system-ui, Helvetica, sans-serif;
    line-height: 1.8em;
    }


.caption {
    text-align: center;
    background-color: rgba(255, 0, 255, 0.2); 
    padding-left: 5%;
    padding-right: 5%;
    padding-top: 2%;
    padding-bottom: 2%;
}

blockquote {
    font-style: italic;
    font-weight: bold;
    color: #FF00FF;

    background-color: rgba(255, 255, 0, 0.2); 
    padding-left: 5%;
    padding-right: 5%;
    padding-top: 2%;
    padding-bottom: 2%;
}


@media  screen and (min-width:  900px) {
    .content, .header {
        width: 60%;
        padding-left: 20%;
        padding-right: 30%;
    }
    .row {
    display: grid;
    grid-template-columns: 75% 25%;
}
    
}

@media  screen and (min-width: 1200px) {
    .content, .header {
        width: 55%;
        padding-left: 20%;
        padding-right: 30%;
    }
    .row {
        display: grid;
        grid-template-columns: 75% 25%;
}
    
}


.date {
      font-style: italic;
}

.cat p {
        line-height: 1em;
}

</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-898010-1', 'auto');
  ga('send', 'pageview');
</script>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6JNHBJL67Q"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6JNHBJL67Q');
</script>

<body>
    <div class="header">
        <h2><a href="/">[ptsefton.com]</a> | <a href="/Pages/cv.html"> [CV & Bio] </a></h2>
    </div>


    <div class="content">
        <h1> 
        Some comments on OOXML, ODF and Microsoft Word 
        </h1>
        <h2>2008-05-12 </h2>

        <div>
<div class="page-toc">
<ul>
<li><a href="#id2">File format conversions</a></li>
<li><a href="#id3">What can we do now?</a></li>
<li><a href="#id4">Some comments on the Microsoft issue</a></li>
</ul>
</div>
<div>
<p>There is a<a href="http://wwmm.ch.cam.ac.uk/blogs/murrayrust/?p=1078">conversation about file formats and word
processors</a> going on
between Peter Murray-Rust and Glyn Moody.</p>
<p>Peter made some comments about wanting access to chemistry publications
in Word format so he can better extract chemical information embedded in
them, which sparked some push-back regarding the Microsoft OOXML format.</p>
<p>Unsurprisingly I have a few opinions on all of this. In this post I'll:</p>
<ol>
<li>
<p>Outline the state of conversion software between OOXML and ODF.
Specifically, .odt and .docx, the word processor formats.</p>
</li>
<li>
<p>Look at what we can do to support researchers right now.</p>
</li>
<li>
<p>Comment on the issues Glyn Moody raises re Microsoft lock-in and
OOXML.</p>
</li>
</ol>
<h1><span id="id2"></span><!--id2--></a>File format conversions</h1>
<p>Peter <a href="http://wwmm.ch.cam.ac.uk/blogs/murrayrust/?p=1078">writes</a>:</p>
<blockquote>
<p>I may be optimstic but it [OOXML] can also be converted to ODT. See
the WP entry:</p>
<p><a href="http://wwmm.ch.cam.ac.uk/blogs/murrayrust/?p=1078">http://wwmm.ch.cam.ac.uk/blogs/murrayrust/?p=1078</a></p>
</blockquote>
<p>Yep. He's optimistic. There are two freely available converters that I
know of, but both of them have a number of practical issues, starting
with which one to choose?</p>
<p>The most mature converter is the <a href="http://odf-converter.sourceforge.net/">ODF Add-in for Microsoft Word, Excel,
and PowerPoint</a> which is open
source but sponsored by Microsoft. I put together a table to try to get
my head around the options. All the converters use the ODF add-in apart
from the last one. I only care about the word processor format, so
that's what I looked at.</p>
<div class="Table48"
style="width: 100%; margin: 0px; padding: 0px; text-align:left;">
<p>+--------------------------+--------------------------+--------------------------+
| Platform                 | Application              | What does it do?         |
+--------------------------+--------------------------+--------------------------+
| Windows                  | Microsoft Word 2003+     | The ODF add-in will read |
|                          |                          | .odt files and turn them |
|                          |                          | into .docx. It's slow.   |
|                          |                          |                          |
|                          |                          | (I couldn't make it run  |
|                          |                          | on my version of Word    |
|                          |                          | 2007 because of what I   |
|                          |                          | think are conflicting    |
|                          |                          | versions of .NET)        |
+--------------------------+--------------------------+--------------------------+
| Windows / Linux          | OpenOffice.org or        | [OpenOffice.org          |
|                          | another ODF aware        | Ninja](http://katana.ooo |
|                          | application (but see     | ninja.com/w/odf-converte |
|                          | below &lt;span              | r-integrator);           |
|                          | class=&quot;spCh spChx2013&quot;&gt;– | a little program that    |
|                          | </span>                  | intervenes when you      |
|                          | are there any?)          | click on a .docx file    |
|                          |                          | and converts it it .odt, |
|                          |                          | slowly.                  |
+--------------------------+--------------------------+--------------------------+
| Windows / Linux          | [Novell's version of     | Uses the ODF Addin and   |
|                          | OpenOffice.org           | allows you to edit a     |
|                          | writer](http://www.novel | .docx file. Open and     |
|                          | l.com/products/desktop/f | save are, you guessed    |
|                          | eatures/ooo.html)        | it, slow.                |
+--------------------------+--------------------------+--------------------------+
| Mac OS X                 | Microsoft Word           | Currently no options for |
|                          |                          | reading ODF AFAIK        |
+--------------------------+--------------------------+--------------------------+
| Mac OS X                 | NeoOffice                | Contains a the Novell    |
|                          |                          | plugin, so you can open  |
|                          |                          | .docx files (slowly, of  |
|                          |                          | course).                 |
+--------------------------+--------------------------+--------------------------+
| Windows, OS X, Linux     | OpenOffice.org Writer    | Contains a new different |
|                          | version 3 (currently in  | converter which is much  |
|                          | beta)                    | faster than the ODF      |
|                          |                          | add-in. But Sun are not  |
|                          |                          | aiming to provide        |
|                          |                          | round-trip editing of    |
|                          |                          | .docx files. This is     |
|                          |                          | intended to be an import |
|                          |                          | filter only.             |
+--------------------------+--------------------------+--------------------------+</p>
</div>
<p>So how to the two technologies perform?</p>
<p>You know, I'm pleasantly surprised to to be reporting that using
NeoOffice on the Mac a complex ICE test document seemed to round trip
from Neo to Word 2008, where I made a few changes and then back to Neo
with no visible problems. This ODF add-in thing has improved a lot since
<a href="http://ptsefton.com/blog/2006/10/23/odf-plugin/">the first time I tried
it</a>.</p>
<p>But I think Microsoft's approach of spo nsoring an open source project
instead of doing the work themselves is very dodgy. The ODF converter
site is hard to use, lots of the documentation is in Word and Excel
downloads instead of proper web pages and it requires an obsolete
version of the .NET framework to run. The site is also big on
<a href="http://odf-converter.sourceforge.net/features.html">frightening lists</a>
of incompatibilities between the formats.</p>
<p>All this seems to me to be designed to say <span
class="spCh spChx201c">“</span>Told you so! Word and ODF are not
compatible cos they use fundamentally different document models.<span
class="spCh spChx201d">”</span></p>
<p>There will never be 100% translation of all the stuff you can do in the
two formats because they are <strong>both</strong> built around existing
implementations that had different feature sets and different document
models. Glyn Moody <a href="http://opendotdotdot.blogspot.com/2008/05/word-in-your-ear.html">puts it like
this</a>:</p>
<blockquote>
<p>They probably won<span class="spCh spChx2019">’</span>t ever work very
well because of the proprietary nature of the OOXML format: there<span
class="spCh spChx2019">’</span>s just too much gunk in there ever to
convert it cleanly to anything.</p>
<p><a href="http://opendotdotdot.blogspot.com/2008/05/word-in-your-ear.html">http://opendotdotdot.blogspot.com/2008/05/word-in-your-ear.html</a></p>
</blockquote>
<p>You can call it <em>gunk</em> but it's just the reality of a legacy format. Me,
I'm glad to have all the gunk out in the open.</p>
<p>But it's not just OOXML that's gunky. Take a look at the list model in
ODF some time; it has this hierarchical list style model that comes
straight out of OpenOffice.org version 1. The user interface in Writer
has never been any good at dealing with these list styles because the
whole thing is just wrong for a word processor. KWord just ignores them,
meaning that it won't interoperate with Writer even though the
developers claim ODF support. Gunk.</p>
<p>Back to testing the ODF converter add-in. Using an ICE document which is
all styles based, the NeoOffice version of the ODF add-in converter
seems to pretty much get it right. I'm impressed.</p>
<p><strong>So how about Sun's importer?</strong> In the beta of Writer 3 it has only one
advantage over the ODF add-in. It's fast. Fast but broken <span
class="spCh spChx2013">–</span> lists and document outlines are an
absolute mess. Of course we already have a document repair function for
documents that follow the <a href="http://ice.usq.edu.au/">ICE</a> style
conventions so we could work around this with our users, but it's not
ready for use in the real world.</p>
<p>And the politics! Sun have OOXML import in OpenOffice.org version 3 but
don't plan to give you the ability to edit OOXML files directly. And the
Microsoft sponsored project takes a similar approach. You can open ODF
files but they automatically get turned into OOXML although you can at
least save to .odt.</p>
<h1><span id="id3"></span><!--id3--></a>What can we do now?</h1>
<p>Now the obligatory <a href="http://ice.usq.edu.au/">ICE</a>-plug.</p>
<p>In the ICE project we have devised a set of styles and associated
templates that can be used for interoperable document authoring. Like
Peter Murray-Rust I want to support Word because that's what researchers
are using. Unlike Peter Murray-Rust my group has not accepted any money
from Microsoft.</p>
<p>Yet.</p>
<p>We have defined a set of structural and semantic styles that you can use
in any word processor <span class="spCh spChx2013">–</span> then even if
the applications can't understand each others formatting in detail they
can still understand <strong>your</strong> documents. If you use the ICE toolbar and
follow a few guidelines then we can make good quality (X)HTML from your
documents and more-or-less move documents from ODF to Word and back.</p>
<p>Not only that, we're building plugins that <a href="http://del.icio.us/ptsefton/ptsefton%2BDataIntegrationForDocuments">understand various
semantics</a>,
like CML for chemistry, graphs and tables, geographical information.</p>
<p>What we do currently is load Word documents into OpenOffice.org via the
old .doc format, save them to .odt (OpenDocument Format Text) and run
some fix-up code over them. The fixups do things like remove spurious
list-styles that Writer adds and fix the document outline. We have not
tackled OOXML, but come Writer version 3 or a version of the Novell
plugin that works with mainstream OpenOffice.org then we'll do the same
thing with .docx. As long as the style names are preserved we can repair
your document. The usual result for Word users is a pretty good XHTML
output but some loss of WYSIWYG for the print view of your document.</p>
<p>ICE is still not that easy for people to try out casually, but we're
working on that we have the server-based version running in beta now and
that's proving much easier for people to get in to.</p>
<h1><span id="id4"></span><!--id4--></a>Some comments on the Microsoft issue</h1>
<p>And a note to Peter's correspondent Glyn Moody who writes:</p>
<blockquote>
<p>Word? OOXML??? Come on, Peter, you want open formats and you<span
class="spCh spChx2019">’</span>re willing to accept one of the most
botched <span class="spCh spChx201c">“</span>standards<span
class="spCh spChx201d">”</span> around, knocked up for purely
political reasons, that includes gobs of proprietary elements and is
probably impossible for anyone other than Microsoft to
implement? *That<span class="spCh spChx2019">’</span>s* open? I
don<span class="spCh spChx2019">’</span>t think so<span
class="spCh spChx2026">…</span>.</p>
<p>XHTML by all means, and if you want a document format the clear choice
is ODF - a tight and widely-implemented standard. Anything but OOXML.</p>
<p><a href="http://opendotdotdot.blogspot.com/2008/05/ooxml-for-petes-sake-no.html">http://opendotdotdot.blogspot.com/2008/05/ooxml-for-petes-sake-no.html</a></p>
</blockquote>
<p>ODT is <strong>not</strong> widely implemented in any meaningful sense. I'd love to
be proved wrong, but <a href="http://ptsefton.com/2008/02/22/opendocument-format-support-not-as-great-as-the-cheer-squad-keep-saying.htm">see my take on
this</a>.
Really. I'd love to see another word processor that can edit .odt files
interoperable with Writer that is <strong>not based on the same code like most
of the contenders</strong>.</p>
<p>Take the example of lists that I raised earlier. To implement an ODF
word processor you would have to implement something that dealt with
hierarchical lists as specified in the standard, and work out how to
cope will all the mess that results from a system where a paragraph has
can have a paragraph style as well as a list style <strong>and</strong> item-level
within the list. And there's a very loose connection between list and
paragraph styles, and a very strange mechanism for embedding extra
paragraphs in a list item. I have never seen a real-life .odt file that
uses the list model properly.</p>
<p>I don't think 'anything but OOXML' is the goal, I prefer <strong>stick to the
interoperable subset of OOXML and ODF</strong>'.</p>
<p>If we stick to the interoperable features that work with current
software then back-end systems like an ICE server can transform Word
documents into ODT and XHTML for archiving, without users having to
worry about it. Even though as far as I can tell there's only one code
base that really works with ODT at least it is open source.</p>
<p>But at the moment we <strong>do</strong> tell our ICE power-users that they're better
off with Writer than Word even if they have to migrate from EndNote to
<a href="http://www.zotero.org/">Zotero</a>.</p>
<p>And Microsoft itself seems happy to drive users to OpenOffice.org. I can
pick which word processor and operating system I want to use, and I
don't like going near Word 2007 for Windows with its stupid ribbon
thing. Too hard to find anything; Writer is much more like Word now than
Word is and it's easy to download and install.</p>
<p>And on the Mac, while Word 2008 doesn't have the ribbon it also misses
out on VBScript, meaning that we can't support it in our ICE system
unless we rewrite our toolbar in AppleScript or whatever it's called.</p>
<p>It's unlikely there's a business case for that. I imagine that the same
will be true in lots of organizations where templates and tie-ins to
corporate systems will no longer be supported on the Mac <span
class="spCh spChx2013">–</span> but it is possible to port macros to
OpenOffice.org and work cross platform. For example, the current ICE
toolbar code is actually a single Basic code-base that works on both
Word and Writer.</p>
<p>And a final comment about the Microsoft sponsored work that PMR's group
are doing. I hope the tools they develop are going to work with
OpenOffice.org and ODF as well, at least to the point that we can
process the data in ICE.</p>
</div>
</div>

    </div><script src="https://utteranc.es/client.js"
            repo="ptsefton/blog-comments"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>  
    </script></body>
</html>