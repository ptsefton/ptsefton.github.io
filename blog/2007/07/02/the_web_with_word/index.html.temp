<html>
<head>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-898010-1";
urchinTracker();
</script>
<title>
ptsefton.com :: Challenge: Produce XHTML and print from a Word document
</title>
</head>
<body>
<script type="text/javascript"><!--
google_ad_client = "pub-4309697012647581";
/* 728x90, created 2/10/08 */
google_ad_slot = "1205309022";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script src="http://pagead2.googlesyndication.com/pagead/show_ads.js" type="text/javascript">
</script>
<!-- SiteSearch Google -->
<form action="http://www.google.com/custom" method="get" target="_top">
<table bgcolor="#ffffff" border="0">
<tr><td align="left" height="32" nowrap="nowrap" valign="top">
</td>
<td nowrap="nowrap">
<input name="domains" type="hidden" value="ptsefton.com"/>
<label for="sbi" style="display: none">Enter your search terms</label>
<input id="sbi" maxlength="255" name="q" size="31" type="text" value=""/>
<label for="sbb" style="display: none">Submit search form</label>
<input id="sbb" name="sa" type="submit" value="Google Search"/>
</td></tr>
<tr>
<td> </td>
<td nowrap="nowrap">
<table>
<tr>
<td>
<input id="ss0" name="sitesearch" type="radio" value=""/>
<label for="ss0" title="Search the Web"><font color="#000000" size="-1">Web</font></label></td>
<td>
<input checked="" id="ss1" name="sitesearch" type="radio" value="ptsefton.com"/>
<label for="ss1" title="Search ptsefton.com"><font color="#000000" size="-1">ptsefton.com</font></label></td>
</tr>
</table>
<input name="client" type="hidden" value="pub-4309697012647581"/>
<input name="forid" type="hidden" value="1"/>
<input name="ie" type="hidden" value="ISO-8859-1"/>
<input name="oe" type="hidden" value="ISO-8859-1"/>
<input name="cof" type="hidden" value="GALT:#008000;GL:1;DIV:#336699;VLC:663399;AH:center;BGC:FFFFFF;LBGC:336699;ALC:0000FF;LC:0000FF;T:000000;GFNT:0000FF;GIMP:0000FF;FORID:1"/>
<input name="hl" type="hidden" value="en"/>
</td></tr></table>
</form>
<!-- SiteSearch Google -->
<h1>Challenge: Produce XHTML and print from a Word document</h1>
<a href="/">Home</a>-<a href="/blog/index.html">blog</a>-<a href="/blog/2007/index.html">2007</a>-<a href="/blog/2007/07/index.html">07</a>-<a href="/blog/2007/07/02/index.html">02</a>
<p align="right"><a href="/blog/2007/07/02/the_web_with_word/100.pdf">View this page as PDF</a></p>
<div><p class="P1">I'm working on a paper about how we <a href="http://del.icio.us/ptsefton/usestyles">use styles</a> in the <a href="http://ice.usq.edu.au/">ICE</a> system to structure and format documents for print and the web. To help define the problem and show why an ICE-like approach is needed I decided to see how far I got trying to format a paper for print and the web using out-of-the-box word processing tools.</p><p>I covered this a little before when I <a href="http://ptsefton.com/blog/2005/10/31/why_do_i_keep_going_on_about_html_export_from_word_processors%3F">got cranky</a> about the HTML export in OpenOffice.org, but I haven't eviscerated Microsoft Word's HTML export here in detail.</p><p>So, here's the challenge. </p><p>Can I take my recent paper, <a href="http://eprints.usq.edu.au/archive/00002653/">An integrated approach to preparing, publishing, presenting and preserving theses</a> for the ETD conference. I <a href="http://ptsefton.com/blog/2007/05/15/etd_paper">wrote recently</a> about how I prepared this paper using ICE, meaning that of course I can produce both print and web versions, but how would I go using Word 2003 on Windows XP? Could I produce XHTML? This is, after all the year 2007 and the World Wide Web is in its late teens. (I didn't use Word 2007 because I don't have a copy, but I'll find one and try that too)</p><p>The biggest challenge, I knew, would be getting stuff that looks OK on screen to export to the correct HTML elements.</p><p>So here's the procedure: (I know this looks boring, but if you know a <code>&lt;ul&gt;</code> from a <code>&lt;p&gt;</code> you'll find it hysterically funny I promise)</p><ol class="lin" style="list-style: decimal;"><li><p>Open a new blank document.</p></li><li><p>Look in the styles pane showing at the left of the page; only a couple of styles there so;</p></li><li><p>Select All styles from the Show drop down:  <a name="graphics1"></a><img alt="graphics1" class="fr1" height="43" src="/blog/2007/07/02/the_web_with_word/1.jpg" style="border:0px;" width="261"/></p></li><li><p>That's better <span class="spCh spChx2013">–</span> there are lots of heading styles and some HTML styles that should come in handy.</p></li><li><p>Select the <code>Title</code> style and type the title</p></li><li><p>Select the <code>Heading 1</code> style and type the first heading (lets forget about the abstract for now)</p></li><li><p>Type a few paragraphs of plain text.</p></li><li><p>Look in the style pane and work out that there's no blockquote style. Weirdly there is a built-in style called <code>HTML Preformatted</code>.</p></li><li><p>Save the document as a web page and note that the  headings have worked.</p></li><li><p>Realize that you've saved it as a <code>.mht</code> whatever that is.</p></li><li><p>Save the document as HTML.</p></li><li><p>Look at the document in Firefox. Looks OK.</p></li><li><p>View source. Yuck!</p></li><li><p>Save the document as Filtered HTML . Hmmmm Filtered.</p></li><li><p>Have a look at the first bit of blockquote:</p>
<pre>&lt;p style='margin-top:13.05pt;margin-right:0cm;margin-bottom:0cm;margin-left:</pre>
<pre>0cm;margin-bottom:.0001pt'&gt;&lt;span lang=EN-US style='font-size:11.0pt'&gt;ICE-RS is</pre>
<pre>supported by the Systemic Infrastructure Initiative as part of the Australian</pre>
<pre>Commonwealth Government's Backing Australia's Ability <span class="spCh spChx2013">–</span> An Innovative Action</pre>
<pre>Plan for the Future (http://backingaus.innovation.gov.au).&lt;/span&gt;&lt;/p&gt;</pre><p>Oh dear!</p><p>(Those extra spans with 11pt text are because I copied an pasted rather than typing: I'd need to turn that into default paragraph font. Easy enough on Windows, but apparently impossible in the Mac version of Word <span class="spCh spChx2013">–</span> they left that bit out!)</p></li><li><p>Use your 1337 skills to change the HTML that word exported to be proper: XHTML:</p>
<pre>&lt;blockquote&gt;ICE-RS is</pre>
<pre>supported by the Systemic Infrastructure Initiative as part of the Australian</pre>
<pre>Commonwealth Government's Backing Australia's Ability - An Innovative Action</pre>
<pre>Plan for the Future (http://backingaus.innovation.gov.au).&lt;/blockquote&gt;</pre></li><li><p>Load the document back in to Word to see what happens.</p></li><li><p>Observe that Word has turned the blockquote abck into a paragraph of Normal text.</p></li><li><p>Save the document.</p></li><li><p>Look at the source.</p>
<pre>&lt;blockquote style="margin-top: 5pt; margin-bottom: 5pt;"&gt;</pre>
<pre>&lt;p class="MsoNormal"&gt;ICE-RS is supported by the Systemic Infrastructure</pre>
<pre>Initiative as part of the Australian Commonwealth Government's Backing</pre>
<pre>Australia's Ability <span class="spCh spChx2013">–</span> An Innovative Action Plan for the Future</pre>
<pre>(http://backingaus.innovation.gov.au).&lt;/p&gt;</pre>
<pre>&lt;/blockquote&gt;</pre><p>Wow! There's still a blockquote there, but guess what? In Word you can't <i>see</i> that it's there!</p></li><li><p>Add some more text to the blockquote by going to the end of the paragraph.</p></li><li><p>Save the document.</p></li><li><p>Check that yes, you have added to the blockquote.</p></li><li><p>Back in the document, experiment with the demote button, the left-facing arrow <code>&lt;-</code>. The first part of the blockquote won't move, but the second will. Here it is as rendered on-screen in Word.</p><p><a name="graphics2"></a><img alt="graphics2" class="fr2" height="69" src="/blog/2007/07/02/the_web_with_word/2.jpg" style="border:0px;" width="552"/></p></li><li><p>Guess what the HTML for that might look like. Here it is rendered in Firefox:</p><p></p><div><a name="graphics3"></a><img alt="graphics3" class="fr3" height="91" src="/blog/2007/07/02/the_web_with_word/3.jpg" style="border:0px;" width="529"/></div></li><li><p>Look at source to see where the text 'Test adding more text ' has gone. </p>
<pre>&lt;blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'&gt;</pre>
<pre>&lt;p class=MsoNormal&gt;ICE-RS is supported by the Systemic Infrastructure</pre>
<pre>Initiative as part of the Australian Commonwealth Government's Backing</pre>
<pre>Australia's Ability <span class="spCh spChx2013">–</span> An Innovative Action Plan for the Future (&lt;a</pre>
<pre>href="http://backingaus.innovation.gov.au/"&gt;http://backingaus.innovation.gov.au&lt;/a&gt;).&lt;/p&gt;</pre>
<pre>&lt;p class=MsoNormal style='margin-left:-180.0pt'&gt;Test adding more text.&lt;/p&gt;</pre>
<pre>&lt;/blockquote&gt;</pre><p>You see that? Word has helpfully put on  margin-left:-180.0pt. Hmm a left margin of minus one hundred and eighty points.</p></li><li><p>Give up in disgust. I can't see a way to get Word 2007 to make a blockquote.</p><p>(And I tried a couple of other things too, like guessing that if I used a style like <code>HTML Blockquote</code> Word might magically Do (Nearly) The Right Thing the way it does with <code>HTML Preformatted</code> style. It doesn't it makes a paragraph with class <code>HTMLBlockquote</code> but with the wrong CSS. Oh well.)</p></li></ol><p>Actually I can't give up because I have yet to play with the lists. </p><p>There's a bit in my paper where I have a blockquote with a list embedded in it. That's pefectly possible in ICE, but would be very hard in Word. So lets look for an easier case.</p><p>So how would we do this example with a numbered list, with some pre-formatted text embedded in it? (note that the actual document has a rendering mistake in it that I have fixed here).</p><p><a name="graphics4"></a><img alt="graphics4" class="fr2" height="336" src="/blog/2007/07/02/the_web_with_word/4.jpg" style="border:0px;" width="552"/></p><p>I used the built-in styles <code>List Number 1</code>, <code>List Continue</code> and <code>HTML Preformatted</code> (with a hit on the indent button).</p><p>Result <i>looks</i> OK in Firefox but it's a million miles from being XHTML. The list is not a list at all, it's a paragraph with some creative formatting and a bunch of non-breaking spaces. Really. I used to know this stuff intimately <span class="spCh spChx2013">–</span> see <a href="http://www.xml.com/pub/a/2004/12/08/word-to-xml.html">my article</a> on geeting XML out of Word for xml.com.</p><pre>&lt;p class=MsoListNumber&gt;&lt;span lang=EN-US&gt;1.&lt;span style='font:7.0pt "Times New Roman"'&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</pre><pre>&lt;/span&gt;&lt;/span&gt;&lt;span lang=EN-US&gt;Initially the handle will resolve to the</pre><pre>server-side ICE repository, which because it is in the Subversion system is</pre><pre>web-addressable, although usually authentication will be required.&lt;/span&gt;&lt;/p&gt;</pre><p>At this point I'd give up, but I love them lists too much. So, why not try ignoring styles and using the formatting buttons.</p><p>Nope. Still no list. It's the same nonsense but without any CSS. </p><pre>&lt;p style="margin-left: 36pt; text-indent: -18pt;"&gt;</pre><pre>&lt;span lang="EN-US"&gt;1.&lt;span style="font-family: &amp;quot;Times New Roman&amp;quot;; </pre><pre>font-style: normal; font-variant: normal; font-weight: normal;</pre><pre> font-size: 7pt; line-height: normal; font-size-adjust: none;</pre><pre>font-stretch: normal;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;/span&gt;</pre><pre>&lt;/span&gt;&lt;span lang="EN-US"&gt;Initially the handle will resolve to the server-side ICE repository,</pre><pre><!--empty--></pre><pre>which because it is in the Subversion system is web-addressable, although</pre><pre>usually authentication will be required.&lt;/span&gt;&lt;/p&gt;</pre><h1><a id="id2" name="id2"><!--id2--></a>Conclusion</h1><p>This sux.</p><p>The worst bit was when I managed to get a word document that contained a blockquote that is invisible through the editing interface, but which creates nightmares like invisible  paragraphs with their left margin miles off the screen.</p><p>If you gave Word 2003  to somebody and asked them to write a paper that could be given to a fussy HTML publisher and also printed with nice headers and footers, or saved to PDF then they'd be stuck. </p><p>Which I kind of knew, which is why we invented ICE. But I needed to go through this so I can show the results for the paper I'm writing. </p><p>Next up, OpenOffice.org Writer. What do you think OOo fans? Will it do any better? An how about Google Docs?</p></div>
</body>
</html>