<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>Introducing the Oni Repository Stack - ptsefton.com</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/index.html">

        <meta name="author" content="Peter Sefton" />
        <meta name="description" content="By: Peter Sefton Moises Sacal Bonequi Alvin Sebastian Mark Raadgever This presentation was delivered by Peter Sefton at Open Repositorites 2023. Abstract In this presentation we will show some of the general purpose repository tooling used to manage repository data for the Language Data Commons of Australia and the Australian ‚Ä¶" />

        <meta property="og:site_name" content="ptsefton.com" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Introducing the Oni Repository Stack"/>
        <meta property="og:url" content="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/index.html"/>
        <meta property="og:description" content="By: Peter Sefton Moises Sacal Bonequi Alvin Sebastian Mark Raadgever This presentation was delivered by Peter Sefton at Open Repositorites 2023. Abstract In this presentation we will show some of the general purpose repository tooling used to manage repository data for the Language Data Commons of Australia and the Australian ‚Ä¶"/>
        <meta property="article:published_time" content="2023-06-13" />
            <meta property="article:section" content="Oni" />
            <meta property="article:author" content="Peter Sefton" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://ptsefton.com/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://ptsefton.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://ptsefton.com/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="https://ptsefton.com/theme/css/style.css" type="text/css"/>

        <link href="https://ptsefton.com/feed/atom" type="application/atom+xml" rel="alternate"
              title="ptsefton.com ATOM Feed"/>
 

<!-- VIA -->
<!-- http://work.smarchal.com/twbscolor/css/e74c3cc0392becf0f1ffbbbc0 -->
<!-- -->
<style>
body {
  font-size: 16px;
}

.figure {
  margin-top: 30px;
  margin-bottom: 30px;
  display: block;
  margin-left: auto;
  margin-right: auto;
  text-align: center;
}

.caption {
  font-style: italic bold;
  text-align: center;

}  


blockquote {
    font-size: 16px;
    font-style: bold;
    background-color: rgb(250, 250, 0);
}


.video-container {
    margin: auto; /* make em equal */
    text-align:center;
    }



/* unvisited link */
a:link {
    color: #FF00FF;
}

/* visited link */
a:visited {
    color: #FF00AA;
}

/* mouse over link */
a:hover {
    color: #FF00AA;
}

/* selected link */
a:active {
    color: #0000FF;
}

section[typeof='http://purl.org/ontology/bibo/Slide'] {
  border-color: #2d262e;
  border-style: solid;
  margin: 30px;
  padding: 10px 10px  10px 10px;
  width: 90%;
}

section[typeof='http://purl.org/ontology/bibo/Slide'] img {
  padding: 20px;
  display: block;
  margin-left: auto;
  margin-right: auto;
  width: 90%;
}

.navbar-default {
  background-color: #ff00ff;
  border-color: #b72bc0;
}
.navbar-default .navbar-brand {
  color: #ffff00;
}
.navbar-default .navbar-brand:hover, .navbar-default .navbar-brand:focus {
  color: #ffff00;
}
.navbar-default .navbar-text {
  color: #ffff00;
}
.navbar-default .navbar-nav > li > a {
  color: #ffff00;
}
.navbar-default .navbar-nav > li > a:hover, .navbar-default .navbar-nav > li > a:focus {
  color: #ffff00;
}
.navbar-default .navbar-nav > .active > a, .navbar-default .navbar-nav > .active > a:hover, .navbar-default .navbar-nav > .active > a:focus {
  color: #ffff00;
  background-color: #b72bc0;
}
.navbar-default .navbar-nav > .open > a, .navbar-default .navbar-nav > .open > a:hover, .navbar-default .navbar-nav > .open > a:focus {
  color: #ffff00;
  background-color: #b72bc0;
}
.navbar-default .navbar-toggle {
  border-color: #b72bc0;
}
.navbar-default .navbar-toggle:hover, .navbar-default .navbar-toggle:focus {
  background-color: #b72bc0;
}
.navbar-default .navbar-toggle .icon-bar {
  background-color: #ffff00;
}
.navbar-default .navbar-collapse,
.navbar-default .navbar-form {
  border-color: #ffff00;
}
.navbar-default .navbar-link {
  color: #ffff00;
}
.navbar-default .navbar-link:hover {
  color: #ffff00;
}

@media (max-width: 767px) {
  .navbar-default .navbar-nav .open .dropdown-menu > li > a {
    color: #ffff00;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover, .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {
    color: #ffff00;
  }
  .navbar-default .navbar-nav .open .dropdown-menu > .active > a, .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover, .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {
    color: #ffff00;
    background-color: #b72bc0;
  }
}
</style>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-898010-1', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://ptsefton.com/" class="navbar-brand">
ptsefton.com            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav" role="menu">
 
                    <li><a href="/">HOME</a></li>
 
                    <li><a href="/cv/">CV</a></li>





		    
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="https://ptsefton.com/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/index.html"
                       rel="bookmark"
                       title="Permalink to Introducing the Oni Repository Stack">
                        Introducing the Oni Repository Stack
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2023-06-13T00:00:00+02:00"> Tue 13 June 2023</time>
    </span>



    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>By:</p>
<ul>
<li>Peter Sefton</li>
<li>Moises Sacal Bonequi</li>
<li>Alvin Sebastian</li>
<li>Mark Raadgever</li>
</ul>
<p>This presentation was delivered by Peter Sefton at Open Repositorites 2023.</p>
<h3>Abstract</h3>
<p>In this presentation we will show some of the general purpose repository tooling used to manage repository data for the Language Data Commons of Australia and the Australian Text Analytics Platform. We have a standards-based repository stack which is used to make research data available for human and machine-use. The main part of the stack is ‚ÄúOni‚Äù https://github.com/Arkisto-Platform/oni which builds an access-controlled REST API from an Oxford Common File Layout (OCFL) data store (which consists of data objects which are saved as files-on-disk or in object storage), with data objects are described using the RO-Crate metadata standard. Data is indexed into a postgres-driven API for low-level access, and a full discovery index implemented in ElasticSearch, with the ability to create access portals in your web framework of choice. We will demonstrate rapid creation of large scale repositories using batch tooling, as well as using a metadata entry tool known as Describo to produce RO-Crate linked-data descriptions.</p>
<p>This slide shows the &quot;small pieces, loosely joined style of the Oni repository&quot; -- it is based on an OCFL data store for digital objects on disk or object storage - with RO-Crate metadata for each object.</p>
<h1>The architecture</h1>
<img src="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/oni_diagrams_oni-architecture-2.svg"/>
<p>This diagram shows the architecture of the Oni system. The name Oni started as an acronym -- Ocfl + NGINX (a web server) + Index (eg Solr or Elastic Search) but we no longer use NGNIX and Oni happens to be a kind of Ogre which has its own emoji üëπ.</p>
<p>This demonstration shows and example of how to stand-up a repository for 300 documents, in this case plays in TEI XML format which we got from <a href="https://orcid.org/0000-0002-9336-1678">Professor Hugh Craig</a>. The first steps involve getting the data into an Oxford Common File Layout <a href="https://ocfl.io">OCFL</a> repository with each &quot;object&quot; (a play) in the repository described using Research Object Crate metadata: RO-Crate.</p>
<h1>Some data ‚Äì ~300 plays from the 1500s</h1>
<img src="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/list-metadata.gif"/>
<p>This screen recording shows a command line session; listing the contents of a data directory full of XML and peeking into the CSV metadata supplied with the files by Professor Craig.</p>
<h1>Using RO-Crate-excel, execute a few maneuvers</h1>
<img src="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/rocxl.mov.gif"/>
<p>In this recording, we use the RO-Crate Excel tool to generate an Excel workbook listing all the files.</p>
<h1>Paste in the researcher's data</h1>
<img src="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/sheet-detail.png"/>
<p>Using Excel, we can manipulate data in a transparent way to get it ready for conversion into RO-Crate format -- the RO-Crate Excel tool uses some conventions that mean we can &quot;show our working&quot; in this process, and mark some of the more esoteric metadata as hidden (for now), though it is still available in the researcher's original ad-hoc CSV format.</p>
<h1>Fine tune using Crate-O ...</h1>
<img src="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/crate-o-org.mov.gif"/>
<p>Here we see the Crate-O metadata tool (which is a zero-install web application that runs in Chrome and other browsers that support the new FilesystemAPI) being used to add an Orgnization as the Affiliation for a Person entity. Having imported this &quot;Context Entity&quot; (that's the RO-Crate term for this type of contextual metadata) it can then be re-used within the crate which we see here as the schema.org <code>publisher</code> property is linked to the same orgnization.</p>
<h1>Here's where you get Crate-O</h1>
<img src="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/crate-o-site.png"/>
<p>You can get the Crate-O source or try it out <a href="https://github.com/Language-Research-Technology/crate-o">at this github repo</a>.</p>
<h1>‚Ä¶ and you get an RO-Crate for the data</h1>
<img src="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/rochtml.mov.gif"/>
<p>This slide shows generating an HTML preview file that summarizes the data -- the RO-Crate is a JSON-LD file that was created from the spreadsheet shown above, and tweaked using Crate-O. JSON-LD is Linked Data in JSON format, this is what RO-Crate uses to make linked data approachable for a general programming audience.</p>
<h1>Then using corpus-tools-ro-crate, make an OCFL repo</h1>
<img src="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/make-plays.mov.gif"/>
<p>This slide shows another script (via a make file that supplies a set of commandline paramaters) which takes the RO-Crate and &quot;explodes&quot; it into a set of OCFL (Oxford Common File Layout) directories in a &quot;Storage Root&quot;.</p>
<h1>This is the OCFL file layout</h1>
<img src="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/ocfl-screenshot.png"/>
<p>Here's what an OCFL repository might look like during development -- I built this on the 'plane to South Africa, somewhere over the Southen Ocean, and you can see that my tweaks to the code resulted in several versions of the OCFL/RO-Crate objects being created. In this recording I navigate to a file, open the RO-Crate Metadata Document, and inspect the metadata profile that it links to from the <code>conformsTo</code> property.</p>
<h1>Start up üëπ and index stuff</h1>
<p>Type, like:</p>
<pre><code>&gt; docker compose up

 ... Screenfulls of stuff

&gt; node structural-index.js 

{ message: 'Started: database indexer' }



</code></pre>
<h1>Et Voila!</h1>
<img src="https://ptsefton.com/2023/06/13/oni-dev-track-or-2023/portal.mov.gif"/>
<p>This is a search portal for the plays with an Elastic search for full text for ~~facets~~ aggregations.</p>
<p>In conclusion, this repository stack is quite different from DSpace, ePrints and other repository systems where everything is built in to one application - the approach is more like the unix</p>
<h1>Tools used here</h1>
<h2>The excel-to-crate tooling:</h2>
<p>https://github.com/Language-Research-Technology/ro-crate-excel</p>
<h2>The plays example</h2>
<p>https://github.com/Language-Research-Technology/corpus-tools-example-plays</p>
<h1>More tools</h1>
<h2>The thing that turns RO-Crate into an OCFL repo:</h2>
<p>https://github.com/Language-Research-Technology/corpus-tools-ro-crate</p>
<h2>The Oni stack, OCFL library, API and Elastic Search:</h2>
<p>https://github.com/Language-Research-Technology/oni-ui</p>

            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'ptsefton'; // required: replace example with your forum shortname

                    var disqus_identifier = 'oni-dev-track-or-2023';
                var disqus_url = 'http://ptsefton.com/2023/06/13/oni-dev-track-or-2023/index.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">


            <li class="list-group-item"><a href="https://ptsefton.com/"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categories</span></h4></a>
                <ul class="list-group" id="categories">
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/acess.html">
                            <i class="fa fa-folder-open fa-lg"></i> Acess
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/arkisto.html">
                            <i class="fa fa-folder-open fa-lg"></i> Arkisto
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/arkisto-platform.html">
                            <i class="fa fa-folder-open fa-lg"></i> Arkisto Platform
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/data-packaging-standards.html">
                            <i class="fa fa-folder-open fa-lg"></i> Data Packaging Standards
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/datacrate.html">
                            <i class="fa fa-folder-open fa-lg"></i> DataCrate
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/datacrate-repositories-eresearch.html">
                            <i class="fa fa-folder-open fa-lg"></i> DataCrate, Repositories, eResearch
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/eresearch.html">
                            <i class="fa fa-folder-open fa-lg"></i> eResearch
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/file-data-capture.html">
                            <i class="fa fa-folder-open fa-lg"></i> File Data Capture
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/housekeeping.html">
                            <i class="fa fa-folder-open fa-lg"></i> Housekeeping
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/how-to.html">
                            <i class="fa fa-folder-open fa-lg"></i> How to
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/jiscpub.html">
                            <i class="fa fa-folder-open fa-lg"></i> jiscPUB
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/metadata.html">
                            <i class="fa fa-folder-open fa-lg"></i> Metadata
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/misc.html">
                            <i class="fa fa-folder-open fa-lg"></i> misc
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/music.html">
                            <i class="fa fa-folder-open fa-lg"></i> Music
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/oni.html">
                            <i class="fa fa-folder-open fa-lg"></i> Oni
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/repositories.html">
                            <i class="fa fa-folder-open fa-lg"></i> Repositories
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/research-data-management.html">
                            <i class="fa fa-folder-open fa-lg"></i> Research Data Management
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/ro-crate.html">
                            <i class="fa fa-folder-open fa-lg"></i> RO-Crate
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/scholarlyhtml.html">
                            <i class="fa fa-folder-open fa-lg"></i> ScholarlyHTML
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="https://ptsefton.com/category/word-processing.html">
                            <i class="fa fa-folder-open fa-lg"></i> Word Processing
                        </a>
                    </li>
                </ul>
            </li>

    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://uts.edu.au/" target="_blank">
                Work
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://ukulelecircus.com/" target="_blank">
                Play
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://twitter.com/ptsefton" target="_blank">
                Twitter: @ptsefton
            </a>
        </li>
        <li class="list-group-item">
            <a href="https://www.flickr.com/photos/25201123@N03/" target="_blank">
                Photos
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
       
      <div class="col-xs-10">
  
        

	&copy; 2023 Peter (Petie) Sefton
	     
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://ptsefton.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://ptsefton.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://ptsefton.com/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'ptsefton'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->

</body>
</html>