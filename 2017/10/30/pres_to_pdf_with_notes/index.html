
<html>
<head>
    <title>ptsefton.com :: How to save a PowerPoint or Impress presentation as a PDF with slide notes from the command line using the descendants of StarOffice; OpenOffice, LibreOffice, soffice</title>
<style>
.header {
  background-color: #ff00ff;
  border-color: #b72bc0;
  color: #ffff00;
  padding-top: 12pt;
  padding-bottom: 12pt;
  font-family: monospace;
}




/* unvisited link */
a:link {
    color: #FF00FF;
}

.header a:link {
    color: #FFFF00;
    text-decoration: none; 
}

button {
    color: #ffff00;
    background-color: #ff00ff;
    font-family: monospace;
}

/* visited link */
a:visited {
    color: #FF00AA;
}

.header a:visited {
    color: #FFFF00;
}

h1, h2 {
    color: # FF00FF
}

/* mouse over link */
a:hover {
    color: #FF00AA;
}

/* selected link */
a:active {
    color: #0000FF;
}

a {
    text-decoration: none; 
}

img {
    max-width: 100%;
    display: block;
    margin-left: auto;
    margin-right: auto;
}
section img {
    width: 100%
}

td, th {
    padding-top: 20px;
    padding-right: 20px;
    vertical-align: top;
    text-align: left;
}

.content {
	font-family: Verdana, system-ui, Helvetica, sans-serif;
    line-height: 1.8em;
    }


.caption {
    text-align: center;
    background-color: rgba(255, 0, 255, 0.2); 
    padding-left: 5%;
    padding-right: 5%;
    padding-top: 2%;
    padding-bottom: 2%;
}

blockquote {
    font-style: italic;
    font-weight: bold;
    color: #FF00FF;

    background-color: rgba(255, 255, 0, 0.2); 
    padding-left: 5%;
    padding-right: 5%;
    padding-top: 2%;
    padding-bottom: 2%;
}


@media  screen and (min-width:  900px) {
    .content, .header {
        width: 60%;
        padding-left: 20%;
        padding-right: 30%;
    }
    .row {
    display: grid;
    grid-template-columns: 75% 25%;
}
    
}

@media  screen and (min-width: 1200px) {
    .content, .header {
        width: 55%;
        padding-left: 20%;
        padding-right: 30%;
    }
    .row {
        display: grid;
        grid-template-columns: 75% 25%;
}
    
}


.date {
      font-style: italic;
}

.cat p {
        line-height: 1em;
}

</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-898010-1', 'auto');
  ga('send', 'pageview');
</script>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6JNHBJL67Q"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6JNHBJL67Q');
</script>

<body>
    <div class="header">
        <h2><a href="/">[ptsefton.com]</a> | <a href="/Pages/cv.html"> [CV & Bio] </a></h2>
    </div>


    <div class="content">
        <h1> 
        How to save a PowerPoint or Impress presentation as a PDF with slide notes from the command line using the descendants of StarOffice; OpenOffice, LibreOffice, soffice 
        </h1>
        <h2>2017-10-30 </h2>

        <p>tl;dr: The magic incantation you need is:</p>
<pre><code>soffice --headless --convert-to pdf:&quot;impress_pdf_Export:ExportNotesPages=True&quot;  'My presentation.pptx'
</code></pre>
<p>Where 'My presentation.pptx' is the path to, you know, your presentation. It can
be in Powerpoint or OpenDocument presentation format (.odp).</p>
<p>It's possible to turn presentations into PDF and many other formats using the
command line, but most of the flags you need to change the behaviour of the
various converters are completely undocumented at <em>both</em> OpenOffice and the
forked project LibreOffice. I had a very hard time figuring out how to save
a presentation as PDF <em>with slide notes</em>, hence this post to help others.</p>
<p><em>NOTE ALSO</em>: the result of saving a presentation as PDF with slide notes in
StarOffice derivatives is a bit odd - you get twice as many pages of PDF as you
have slides. For presentations with <em>p</em> pages the first <em>p</em> slides are the
slides without notes and the second <em>p</em> have both the slide and the notes
(unless the notes are too long in which case they are cut off). This doesn't
bother me, I don't actually want the PDF as such, I am working on a script to
turn the PDF into a series of images, extract the slide and notes text and wrap
them in a markdown document so I can publish presentations here. I'll put that
up on github soon.  If anyone knows other flags with better behaviour, then
please let me know. A complete list of conversion flags would be great, like for
example how to trigger all the HTML export options. Ta.</p>
<p>The key, hard to find part of this is the flag:
&quot;impress_pdf_Export:ExportNotesPages=True&quot;.</p>
<p>NOTE: on some platforms the binary might be <code>libreoffice</code> or some other
variant rather than <code>soffice</code>.</p>
<h1>To get set up OS X so you can just type <code>soffice</code></h1>
<ul>
<li>Install LibreOffice</li>
<li>Type this in a terminal:
<code>sudo ln -s  /Applications/LibreOffice.app/Contents/MacOS/soffice /usr/local/bin/soffice</code></li>
</ul>
<p>There's a handy tool that wraps the soffice binary called <a href="https://github.com/dagwieers/unoconv/">unoconv</a> (installable
with brew install unoconv) that provides an abstracted interface with a few
extra features over typing <code>soffice</code> but <a href="https://github.com/dagwieers/unoconv/issues/391#issuecomment-336716901">at the moment it doesn't work on
OS X</a>
with recent versions of LibreOffice.</p>

    </div><script src="https://utteranc.es/client.js"
            repo="ptsefton/blog-comments"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>  
    </script></body>
</html>