
<html>
<head>
    <title>ptsefton.com :: ICE and word processor / HTML interop, the ugly, uglier, ugliest</title>
<style>
.header {
    
  background-color: #ff00ff;
  border-color: #b72bc0;
  color: #ffff00;
  padding-top: 12pt;
  padding-bottom: 12pt;
  font-family: monospace;
}




/* unvisited link */
a:link {
    color: #FF00FF;
}

.header a:link {
    color: #FFFF00;
    text-decoration: none; 
}

button {
    color: #ffff00;
    background-color: #ff00ff;
    font-family: monospace;
}

/* visited link */
a:visited {
    color: #FF00AA;
}

.header a:visited {
    color: #FFFF00;
}

h1, h2 {
    color: # FF00FF
}

/* mouse over link */
a:hover {
    color: #FF00AA;
}

/* selected link */
a:active {
    color: #0000FF;
}

a {
    text-decoration: none; 
}

img {
    max-width: 100%
}
section img {
    width: 100%
}
td, th {
    padding-top: 20px;
    padding-right: 20px;
    vertical-align: top;
    text-align: left;
}

.content {
	font-family: Verdana, system-ui, Helvetica, sans-serif;
    line-height: 1.8em;
    }



@media  screen and (min-width: 500px) {
    .content, .header {
        width: 60%;
        padding-left: 20%;
        padding-right: 30%;
    }
    
}

@media  screen and (min-width: 700px) {
    .content, .header {
        width: 40%;
        padding-left: 20%;
        padding-right: 30%;
    }
    
}


</style>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-898010-1', 'auto');
  ga('send', 'pageview');

</script>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6JNHBJL67Q"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6JNHBJL67Q');
</script>
<body>
<div class="header">
<h2><a href="/">[ptsefton.com]</a> | <a href="/Pages/cv.html"> [CV & Bio] </a></h2>


</div>


<div class="content">
<h1> 
ICE and word processor / HTML interop, the ugly, uglier, ugliest 
</h1>
<h2>2010-05-14 </h2>

<div>
<div class="page-toc">
</div>
<div>
<p>[Update: finished an unfinished sentence, added a link]</p>
<p>We have started having post-Friday-morning-tea information sessions in
the ADIF technical team. Ron Ward kicked the series off with a great
overview of Javascript which is both the world's most widely deployed
and worst misunderstood language and Greg Pendlebury introduced us to
some of the wonders of spelling suggestions in Apache Solr indexes (he
works nights on the VuFind project).</p>
<p>My contribution is this presentation on ICE, below, looking at how it
converts word processing documents into HTML, and some of the
complexities that the ICE code has to deal with. These complexities are
technical, horribly so in some cases. Many of the complexities are
present not for good technical reasons but because of business and
politics; competing vendors and competing standards have left us a
really nasty mess to deal with.</p>
<p>My talk started with some history. When I first got my hands on a
WYSIWYG word processor, around 1988 or so, the first thing I did was go
through all the menus and work out what everything was <em>for</em>. For my
honours thesis in 1990 I naturally used styles for the headings, so I
could compile a table of context and the automatic numbering feature for
figures, EndNote for references and so on. I was far too lazy to do any
of that by hand.</p>
<p>Twenty years later, those features are still in the word processors we
all use (although Google Docs is a disappointment), and we now
have<a href="http://zotero.org/">Zotero</a> for reference management, to which we
in ADFI made a modest contribution. But I still meet senior academics
who have no idea how to use styles to make a table of contents, don't
use reference management systems and consequently are unable to help
their students to work efficiently.</p>
<p>There a couple of interesting questions, which I'm not going to answer
here, but which are important to the research planning process at ADFI:</p>
<ol>
<li>
<p>What are the word processors of the future going to look like? It's
clear that we will still need to 'process words' and some of them
will still be strung together in long sequences, like books and
theses, but other more dynamic genres are emerging. I've written
here about <a href="http://ptsefton.com/2009/11/02/a-bit-more-on-wave-as-a-scholarly-html-editor.htm">Google
Wave</a>
(which seems to have receded leaving behind only plastic bottles and
dead fish) and various other new approaches to editing. I don't know
what's coming but I am sure it will be collaborative.</p>
</li>
<li>
<p>How can we help people to use these programs for processing words?</p>
</li>
<li>
<p>Shouldn't our training programmes for academics be more like <span
class="spCh spChx201c">“</span>Word processing techniques for
academic writing, using Word 2007<span
class="spCh spChx201d">”</span> than the current <span
class="spCh spChx201c">“</span>Word 2007 basics<span
class="spCh spChx201d">”</span>? How would we go about making that
change?</p>
</li>
<li>
<p>More generally, how can we encourage the kind of laziness that
prompts some of us to discover the bleeding obvious things that are
under out noses, by doing things like RTFM? And how do we create a
culture where that know-how can spread?</p>
</li>
<li>
<p>And what do we do when what we need is not there right under our
noses? For example we need the ability to produce Scholarly HTML
from our documents but current tools just don't do that. How can we
get the academic community and software vendors, including us in the
open source world, in-sync to fill in the gaps?</p>
<p>Next week I have a call with Microsoft Research, and I'll be talking
about getting Word to be able to produce web-ready, journal ready,
semantically rich documents, with useful metadata and seamless links
to data and interop with other programs like OpenOffice.org. Note,
I'm not looking at this from the point of view of a 'standards war';
I'm trying to get thing <strong>done</strong>.</p>
</li>
</ol>
<p>When I ran through the slides below today we came back to these
questions. We didn't get any answers in half an hour, but my summary of
what we should be doing is:</p>
<ol>
<li>
<p>Finally get around to setting up one or more cohorts of postgrad
students with an end-to end system for managing their thesis
starting from day one, and including a facilty for
annotation/comment by supervisor, cohort and finally examiners.</p>
</li>
<li>
<p>Work out how to educate (not train) the trainers about some of the
principles behind academic use of tools.</p>
</li>
<li>
<p>Work with our Learning and Teaching Support Unit to start changing
the corporate training culture away from teaching specific tools
with a generic focus to empowering academic users to do academic
things.</p>
</li>
</ol>
<div class="slide">
<h1>What and why?</h1>
<p><a href="http://ice.usq.edu.au/">ICE</a>is, at it's core a way of turning word
processing documents into <strong>proper</strong> web pages.</p>
<p>Word processors are:</p>
<ol>
<li>
<p><strong>Ubiquitous in academia</strong>. Still. Even with the advent of Moodle's
built in HTML editor and Google Wave.</p>
</li>
<li>
<p><strong>Much maligned</strong>, particularly by computer scientists, engineers
and expert tinkerers who have much better ways of making web pages
and printed documents from the same source (until you ask them to
show you).</p>
</li>
<li>
<p><strong>Full of useful features</strong> for long documents, including:</p>
<ol>
<li>
<p>Drawing tools</p>
</li>
<li>
<p>Data visualisation tools (charting)</p>
</li>
<li>
<p>Reference and bibliography management (usually best with a
plugin)</p>
</li>
<li>
<p>Change-tracking (and some have synchronous collaboration)</p>
</li>
<li>
<p>HTML export...</p>
</li>
</ol>
</li>
</ol>
</div>
<div class="slide">
<h1>HTML export?</h1>
<p>OK, so the HTML export in word processors is universally crappy.</p>
<p>This is one of the great mysteries of the universe.</p>
<p>Actually it's not <span class="spCh spChx2013">–</span> Microsoft made a
concerted attempt in the late nineties to make their office suite part
of the web, and to add their own extensions to HTML By 2000 they were
the only major player left in the word processing world and I guess they
thought they had a shot at owning the web. It has taken nearly 10 years
for us to get back to something like a multiple-horse race. Ironically
the widely ridiculed Word 2000 save as web format was actually very easy
to process into XML and to use to produce good quality web pages; it
took years to generate the current OOXML approach which is much less
useful. (<a href="http://www.xml.com/pub/a/2004/12/08/word-to-xml.html">I wrote about his for
XML.com</a>).</p>
<p>It is a mystery why Google Docs is so bad, though. I had corresponded
with one of the people from Google Docs about <a href="http://ptsefton.com/blog/2007/10/03/10-01-45.649977/">making it
better</a>, but he
lost interest.</p>
</div>
<div class="slide">
<h1>In 1995...</h1>
<p>The technical writing team at TAFE NSW information systems division
decided to put our technical bulletins on the web. (We started this work
before HTML even had tables, BTW).</p>
<ul>
<li>
<p>We <a href="http://delicious.com/ptsefton/ptsefton+usestyles">used word processing
styles</a>, because
that was (and still is) what sensible, rational people do.</p>
</li>
<li>
<p>I rolled my own process based on: RTF via Rainbow maker to SGML, to
ESIS via nsgmls to HTML via Perl + SGMLSpm.</p>
<p>The current ICE conversion system is quite similar <span
class="spCh spChx2013">–</span> uses an event driven XML (SAX
process and a scripting language, it's just that word processors now
produce their own XML.</p>
<p>In between I have used
<a href="http://en.wikipedia.org/wiki/OmniMark">Omnimark</a> (which was just
plain weird), <a href="http://www.jclark.com/dsssl/">DSSSL</a> (which was
Scheme, which is a kind of Lisp), XSLT (dumbed-down DSSSL with XML
syntax) which we dumped in ICE for performance/maintainability
reasons, and the free-as-in-beer
<a href="http://99-bottles-of-beer.net/language-ace-15.html">ACE</a> language
that came with TeraText (from RMIT).</p>
</li>
</ul>
<p>In those days:</p>
<ul>
<li>
<p>Image handling was tricky <span class="spCh spChx2013">–</span> it
was hard to convert embedded objects to web formats.</p>
</li>
<li>
<p>I thought that the next version of Word would ship with syle-to-web
mapping and I could stop working on this distraction<span
class="footnote"
style="vertical-align: super;"><a href="#ftn1" title="* I was just taking a short break from computational linguistics which turned out to be easier than making web pages, in retrospect.">*</a></span>.</p>
</li>
</ul>
</div>
<div class="slide">
<h1>Styles</h1>
<p>In 2010, we're writing software at ADFI that uses very similar styles to
the ones used in 1995 at TAFE, which I refined for use at Standards
Australia then NextEd before starting the ICE project at USQ. The ICE
style-set is <a href="http://eprints.usq.edu.au/697/">defined in my 2006 paper</a>.</p>
</div>
<div class="slide">
<h1>I promised you ugliness</h1>
<p>Styles are sensible and useful. But:</p>
<ul>
<li>
<p><strong>There are no standards</strong>. The only thing close to a standard is
the use of Title, Heading 1 <span class="spCh spChx2026">…</span>
Heading n. How do you handle a mixture of numbered headings and
non-numbered headings. What about chapter numbering?</p>
</li>
<li>
<p><strong>There is no standard even for a single vendor for an ordinary
paragraph</strong>: Normal, Default Default Text etc.</p>
</li>
<li>
<p>Even individual <strong>vendors don't stick to or ship a set of styles</strong>
for things like lists or quotes in their sample templates.</p>
</li>
<li>
<p>Word and Open Office and Google Docs <strong>all</strong> produce <strong>different</strong>
rubbish when asked to make web pages and make almost no use of
styles in doing so.</p>
</li>
</ul>
</div>
<div class="slide">
<h1>And worse...</h1>
<p>Like here are some of the favourites from the team:</p>
<ul>
<li>
<p>There are some circumstances under which Word 2007 does not export
graphics when saving as HTML (happened to Ron <span
class="spCh spChx2013">–</span> not sure if it is reproducible).</p>
</li>
<li>
<p>Page breaks and section breaks probably cost society a lot more than
terrorism and smoking combined.</p>
</li>
<li>
<p>We have not forgotten or forgiven the paper-clip; have they
apologised yet?</p>
</li>
<li>
<p>Word used to (and still does) get into states where things fly
around randomly.</p>
</li>
</ul>
<p>Look, if O'Reilly publishes a book entitled <span
class="spCh spChx201c">“</span>&lt;name-of-your-product&gt; Annoyances<span
class="spCh spChx201d">”</span> you have a problem. If nobody bothers,
as with OpenOffice,org then you probably have a bigger problem.</p>
</div>
<div class="slide">
<h1>And worse...</h1>
<p>Here's a list I created using the bullets and numbering toolbar in
Writer:</p>
<p><a name="graphics1"></a><img src="/wp-content/uploads/2010/05/6f671eae1.png" alt="graphics1"></p>
<p>ODF has hierarchical list structures (one of the worst decisions ever).
Now, you'd think that if we were going to have hierarchical list
structures this might be, you know hierarchical, like one list embedded
in another. Instead we get this :</p>
<blockquote>
<p>&lt;<code>text:list xml:id=&quot;list1916064342&quot; text:style-name=&quot;L1&quot;&gt;</code></p>
<p><code>&lt;text:list-item&gt;&lt;text:p text:style-name=&quot;P1&quot;&gt;Bullet list &lt;/text:p&gt;&lt;/text:list-item&gt;</code></p>
<p><code>&lt;/text:list&gt;</code></p>
<p><code>&lt;text:list xml:id=&quot;list1908078027&quot; text:style-name=&quot;L2&quot;&gt;</code></p>
<p><code>&lt;text:list-item&gt;</code></p>
<p><code>&lt;text:list&gt;</code></p>
<p><code>&lt;text:list-item&gt;</code></p>
<p><code>&lt;text:p text:style-name=&quot;P2&quot;&gt;Number list &lt;/text:p&gt;&lt;/text:list-item&gt;</code></p>
<p><code>&lt;text:list-item&gt;</code></p>
<p><code>&lt;text:p text:style-name=&quot;P2&quot;&gt;Number list&lt;/text:p&gt;&lt;/text:list-item&gt;&lt;/text:list&gt;</code></p>
<p><code>&lt;/text:list-item&gt;&lt;/text:list&gt;</code></p>
<p><code>&lt;text:list xml:id=&quot;list322315948&quot; text:style-name=&quot;L3&quot;&gt;&lt;text:list-item&gt;&lt;text:p text:style-name=&quot;P3&quot;&gt;Bullet list&lt;/text:p&gt;&lt;/text:list-item&gt;&lt;/text:list&gt;</code></p>
</blockquote>
<p>Bizarre. Truly. The 'main' list is three lists. That 'middle' numbered
list is a single element list with no text with a two element list
embedded in it.</p>
<p>I promise all I did was push the buttons on the toolbar. Pushing them in
a different order gets you different craziness.</p>
</div>
<div class="slide">
<h1>Word's OOXML has a more rational approach</h1>
<p>OOXML is flat - the list formatting is implied. Each paragraph is a
paragraph and the fact that they belong in a list structure is indicated
with attributes. Given that word processors have a paragraph based
interface this is rational.</p>
<p><a name="graphics3"></a><img src="/wp-content/uploads/2010/05/201d28ad1.png" alt="graphics3"></p>
<p>This kind of markup scares some people, but it's very efficient:</p>
<blockquote>
<p>&lt;w:p w:rsidR=&quot;009B3D58&quot; w:rsidRDefault=&quot;002D3C0B&quot;
w:rsidP=&quot;002D3C0B&quot;&gt;&lt;w:pPr&gt;&lt;w:pStyle
w:val=&quot;ListParagraph&quot;/&gt;&lt;w:numPr&gt;&lt;w:ilvl w:val=&quot;0&quot;/&gt;&lt;w:numId
w:val=&quot;1&quot;/&gt;&lt;/w:numPr&gt;&lt;/w:pPr&gt;&lt;w:r&gt;&lt;w:t&gt;Bullet
list&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;</p>
<p>&lt;w:p w:rsidR=&quot;002D3C0B&quot; w:rsidRDefault=&quot;002D3C0B&quot;
w:rsidP=&quot;002D3C0B&quot;&gt;&lt;w:pPr&gt;&lt;w:pStyle
w:val=&quot;ListParagraph&quot;/&gt;&lt;w:numPr&gt;&lt;w:ilvl w:val=&quot;1&quot;/&gt;&lt;w:numId
w:val=&quot;2&quot;/&gt;&lt;/w:numPr&gt;&lt;/w:pPr&gt;&lt;w:r&gt;&lt;w:t&gt;Numbered
list&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;</p>
<p>&lt;w:p w:rsidR=&quot;002D3C0B&quot; w:rsidRDefault=&quot;002D3C0B&quot;
w:rsidP=&quot;002D3C0B&quot;&gt;&lt;w:pPr&gt;&lt;w:pStyle
w:val=&quot;ListParagraph&quot;/&gt;&lt;w:numPr&gt;&lt;w:ilvl w:val=&quot;1&quot;/&gt;&lt;w:numId
w:val=&quot;2&quot;/&gt;&lt;/w:numPr&gt;&lt;/w:pPr&gt;&lt;w:r&gt;&lt;w:t&gt;Numbered
list&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p&gt;</p>
<p>&lt;w:p w:rsidR=&quot;002D3C0B&quot; w:rsidRDefault=&quot;002D3C0B&quot;
w:rsidP=&quot;002D3C0B&quot;&gt;&lt;w:pPr&gt;&lt;w:pStyle
w:val=&quot;ListParagraph&quot;/&gt;&lt;w:numPr&gt;&lt;w:ilvl w:val=&quot;0&quot;/&gt;&lt;w:numId
w:val=&quot;1&quot;/&gt;&lt;/w:numPr&gt;&lt;/w:pPr&gt;&lt;w:r&gt;&lt;w:t&gt;Bullet
list&lt;/w:t&gt;&lt;/w:r&gt;&lt;/w:p</p>
</blockquote>
</div>
<div class="slide">
<h1>But not that rational</h1>
<p>So <span class="spCh spChx2013">–</span> Word's better, right? Not
really. There are several ways to make lists in Word:</p>
<ul>
<li>
<p><strong>Ad hoc lists</strong> using the toolbar buttons which is likely the only
thing casual users will discover in Word 2007 (there are no
list-type styles showing in any of the ribbon galleries).</p>
</li>
<li>
<p>Using <strong>anonymous multi-level list structures</strong> <span
class="spCh spChx2013">–</span> you can define these via the styles
part of the ribbon, but not name them.</p>
</li>
<li>
<p>Using <strong>named list outlines</strong> which you get to from a DIFFERENT
place on the ribbon (not the styles part) but which point back to
styles.</p>
</li>
<li>
<p>Using <strong>list styles</strong> <span class="spCh spChx2013">–</span> which
were introduced in Word 2003 <span class="spCh spChx2013">–</span>
but you know, I can't find them in Word 2007 although apparently
they're there somewhere.</p>
</li>
</ul>
<p>Here's the <a href="http://blogs.msdn.com/microsoft_office_word/archive/2010/01/28/the-why-behind-our-styles-and-lists-designs.aspx">attempted explanation on the Word
blog</a>.
Read that and I'm sure you'll feel much better about the ribbon in Word
2007. It was <strong>for your own good</strong>.</p>
</div>
<div class="slide">
<h1>So in ICE we try to do the right thing</h1>
<p>We try to:</p>
<ul>
<li>
<p>Produce sensible HTML using whatever cues the document contains:</p>
<ul>
<li>
<p>Styles, obviously make that very clear, but even with styles if
someone has a third level list style following an ordinary
paragraph ICE will not try to create some kind nested list
structure or add a big margin it will produce sensible
structured HTML.</p>
</li>
<li>
<p>Lately, we have been adding code to try to interpret direct
formatting but this approach is never going to be as robust as
using styles and it is very hard when using, say Word and Writer
on the same document.</p>
</li>
</ul>
</li>
<li>
<p>Provide a toolbar which tries to generate sensible structure <span
class="spCh spChx2013">–</span> eg if you hit the block-quote button
in a paragraph under bullet list it will indent the quote under the
list.</p>
</li>
</ul>
</div>
<p>Copyright Peter Sefton, 2010. Licensed under Creative Commons
Attribution-Share Alike 2.5 Australia.
&lt;<a href="http://creativecommons.org/licenses/by-sa/2.5/au/">http://creativecommons.org/licenses/by-sa/2.5/au/</a>&gt;</p>
<p><span class="Default_20_Paragraph_20_Font"><span
style="country:US; language:en; "><span
class="T1"><a name="HTTP:::DBPEDIA.ORG:SNORQL:?QUERY=SELECT+%3FRESOURCE%0D%0AWHERE+{+%0D%0A%3FRESOURCE+%3CHTTP%3A%2F%2FDBPEDIA.ORG%2FONTOLOGY%2FPERSON%2FBIRTHPLACE%3E+%3CHTTP%3A%2F%2FDBPEDIA.ORG%2FRESOURCE%2FSYDNEY%3E+%3B%0D%0A%3CHTTP%3A%2F%2FDBPEDIA.ORG%2FONTOLOGY%2FPERSON%"></a><img src="/wp-content/uploads/2010/05/m40ca94ba1.png" alt="HTTP://DBPEDIA.ORG/SNORQL/?QUERY=SELECT+%3FRESOURCE%0D%0AWHERE+{+%0D%0A%3FRESOURCE+%3CHTTP%3A%2F%2FDBPEDIA.ORG%2FONTOLOGY%2FPERSON%2FBIRTHPLACE%3E+%3CHTTP%3A%2F%2FDBPEDIA.ORG%2FRESOURCE%2FSYDNEY%3E+%3B%0D%0A%3CHTTP%3A%2F%2FDBPEDIA.ORG%2FONTOLOGY%2FPERSON%"></span></span></span></p>
<p>This post was written in OpenOffice.org, using templates and tools
provided by the <a href="http://ice.usq.edu.au/">Integrated Content Environment</a>
project and published to WordPress using <a href="http://fascinator.usq.edu.au/desktop/desktop.htm">The
Fascinator</a>.</p>
<hr>
<div style="font-size: .9em;">
<p><span class="footnote-defined"><a href="#ftn1-text">*</a> I was just taking a
short break from computational linguistics which turned out to be easier
than making web pages, in retrospect.</span></p>
</div>
</div>
</div>

</div><script src="https://utteranc.es/client.js"
        repo="ptsefton/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script></body>
</html>